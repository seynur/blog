---
layout: default
title: "Splunk + MCP Architecture: Bridging LLMs and Operational Data"
summary: "This article explores the core concepts ofÂ Model Context Protocol (MCP)Â and MCP Servers, andÂ demonstrates how they can be applied in a real-world Splunk use case using Claude."
author: Hilal Gevrek
image: /assets/img/blog/2026-01-17-mcp.webp
date: 17-01-2026
tags: model-context-protocol artificial-intelligence large-language-model claude splunk
categories: Splunk

---

# Splunk + MCP Architecture: Bridging LLMs and Operational Data

**Large Language Models (LLMs)**Â are becoming increasingly capable, but their true potential is unlocked only through direct interaction with real systems. Without access to logs, metrics, APIs, and services, anÂ **LLM is limited to isolated text generation and lacks operational context.**

TheÂ [**Model Context Protocol (MCP)**](https://modelcontextprotocol.io/docs/getting-started/intro)Â is an open-source standardÂ **that aims to overcome these limitations**Â by defining a standardized and controlled way for AI models to interact with external systems, tools, and data sources.

This article explores the core concepts ofÂ **Model Context Protocol (MCP)**Â and **MCP Servers**, andÂ **demonstrates how they can be applied in a real-world Splunk use case using Claude.**

### **Model ContextÂ Protocol**

As previously mentioned,Â **MCP defines how AI models interact with external tools and data sources**. Its primary objective is to establish a standardized and controlledÂ **communication layer that connects AI systems with real-world services and data**.

MCP is structured inÂ **two layers**: anÂ **inner data layer**Â that defines theÂ *JSON-RPC protocol*Â and core primitives (*tools, resources, prompts*), and anÂ **outer**Â **transport layer**Â that handles communication mechanisms such as connection establishment, message framing, and authorization.

Within this framework, the MCP Server acts as an intermediary,Â **exposing**Â **tools, data,**Â andÂ **prompts**Â in a structured and discoverable format. ThisÂ **enables models to dynamically identify available capabilities and interact with them**without relying on custom or hardcoded integrations.

The following image illustrates theÂ architectural difference between direct system integrations and an MCP-based approach. Without MCP, the LLM integrates separately with each systemâ€™s API; with MCP, integrations are handled through a unified protocol layer.

<p align="center">
  <img src="/assets/img/blog/2026-01-17-mcp-before-and-after.webp" alt="LLM Integration: Before vs. After MCP Adoption" width="600"/>
  <br><em>LLM Integration: Before vs. After MCP Adoption</em>
</p>

Before MCP, API calls could achieve similar results, but MCP brings context-awareness and structure, enabling LLMs to autonomously discover and use tools based on context and intent, making their interactions more practical, secure, and dynamic.

### **How an MCP ServerÂ Works?**

In a typical configuration, theÂ **AI model**Â runs inside a host application, such as a UI or agent, where the model is executed. AnÂ **MCP client**Â within this host enables the model to communicate with external systems using theÂ **MCP protocol**.

The MCP client connects to theÂ **MCP Server**, whichÂ **exposes available tools and resources**. The server informs the model about what actions it can perform. The model then requests the needed data or action through the client. The server executes the request and returns the results in a format the model can easily use.

The following image and steps illustrate this flow.

<p align="center">
  <img src="/assets/img/blog/2026-01-17-mcp-flow.webp" alt="MCP Architecture Flow" width="600"/>
  <br><em>MCP Architecture Flow</em>
</p>

**1ï¸âƒ£**Â TheÂ **Host**Â is the main application where the LLM runs (such as ChatGPT Desktop or Claude Desktop).

**2ï¸âƒ£**Â TheÂ **MCP Client**, embedded in the host (provided by the LLM), enables the model to communicate using theÂ **MCP protocol**Â (which uses JSON-RPC).

**3ï¸âƒ£**Â TheÂ **MCP Server**Â advertises available tools and resources, such as Splunk search or log retrieval.

**4ï¸âƒ£**Â The LLM selects and invokes the appropriate tool via the MCP client.

**5ï¸âƒ£**Â The MCP Server executes the request on the corresponding external system, such as Splunk.

6ï¸âƒ£ Results are returned in a structured format that the LLM can understand and reason over.

### **Why Use an MCPÂ Server?**

- Eliminates the need for custom, model-specific integrations by providingÂ **a standardized interface to external systems**.
- Centralizes access to tools and data,Â **improving consistency and security**by avoiding integration logic embedded within individual AI applications.
- Simplifies scaling and maintenance asÂ **new capabilities are added to AI systems**.
- Remains agnostic to both models and platforms,Â **enabling the same integration layer to be reused across different AI systems without modification**.
- **Transforms an LLM from a simple API-calling interpreter**Â into an autonomous agent capable of dynamically discovering and using tools based on context and intent.

### **MCP-Based Integration Between Claude andÂ Splunk**

This section demonstrates an MCP-based integration between Claude and Splunk at a conceptual level. The focus is on the integration pattern, providing a clear conceptual understanding rather than a real-world production scenario.

The steps below describe how this integration can be implemented:

> âš ï¸ This setup is designed forÂ testing purposesÂ only. Implementing it in a production environment without proper planning and safeguards may lead to security vulnerabilities.
> 

### **ğŸ§©Â Step 1:Â Download the RequiredÂ Tools**

- [DownloadÂ **Claude Desktop**](https://claude.com/download)
- [DownloadÂ **Splunk Enterprise**](https://www.splunk.com/en_us/download/splunk-enterprise.html)
- [DownloadÂ **Splunk MCP Server**](https://splunkbase.splunk.com/app/7931)
- [DownloadÂ **Splunk AI Assistant for SPL**](https://splunkbase.splunk.com/app/7245)Â (Optional)

### **ğŸ§©Â Step 2: Prepare Splunk for Configuration**

- Navigate to theÂ `/opt/splunk/etc/apps`Â directory and place the Splunk application files (Splunk MCP Server & Splunk AI Assistant for SPL).
- Restart the Splunk service to apply the changes.
- Create an authentication token for secure access between Claude MCP Client and Splunk MCP Server. ([Use Splunk Web to create authentication tokens](https://help.splunk.com/en/splunk-enterprise/administer/manage-users-and-security/10.0/authenticate-into-the-splunk-platform-with-tokens/create-authentication-tokens))

ğŸ«§Â **[Splunk MCP Server](https://help.splunk.com/en/splunk-cloud-platform/mcp-server-for-splunk-platform/about-the-mcp-server-for-splunk-platform):**

The Splunk MCP Server is deployed as aÂ **centrally hosted service that accepts connections from multiple MCP clients across different environments**.

This centralized deployment allows tools exposed by the Splunk MCP Server to be reused across different clients without requiring local installations or duplicated configurations.Â **Clients connect to the MCP Server using the MCP protocol**Â to interact with Splunk operational data in a controlled and standardized way.

TheÂ **available tools**Â (as shown in the image below)Â **define the specific Splunk capabilities**Â that can be accessed by LLMs, including search execution, metadata retrieval, and other operational interactions, while keeping data access centralized and governed.

<p align="center">
  <img src="/assets/img/blog/2026-01-17-splunk-mcp-server-tools.webp" alt="Tools Provided by the Splunk MCP Server" width="600"/>
  <br><em>Tools Provided by the Splunk MCP Server</em>
</p>

ğŸ«§Â **[Splunk AI Assistant for SPL](https://help.splunk.com/en/splunk-cloud-platform/search/splunk-ai-assistant-for-spl/1.0.5/about-splunk-ai-assistant-for-spl/about-splunk-ai-assistant-for-spl):**

The Splunk AI Assistant for SPL is the recommended interface, according to the official Splunk documentation, for interacting with SPL in MCP-enabled workflows.

To expose AI tools such asÂ `generate_spl`,Â `explain_spl`,Â `optimize_spl`, andÂ `ask_splunk_question`Â through the MCP Server, the Splunk AI Assistant for SPL must be installed.

### **ğŸ§© Step 3: Configure the Splunk MCP Server and Claude MCPÂ Client**

In this step, configure the Claude MCP Client to connect to the Splunk MCP Server by updating theÂ `claude_desktop_config.json`Â file with theÂ **server endpoint**Â shown in the Splunk MCP Server interface and theÂ **authentication token**Â created in the previous step.

    {
      "mcpServers": {
        "splunk-mcp-server": {
          "command": "npx",
          "args": [
            "-y",
            "mcp-remote",
            "https://<MCP_SERVER_ENDPOINT>",
            "--header",
            "Authorization: Bearer <YOUR_TOKEN>"
      ],
          "env": {
            "NODE_TLS_REJECT_UNAUTHORIZED": "0"
          }
        }
      }
    }

- ReplaceÂ `<MCP_SERVER_ENDPOINT>`Â with the actual URL of your Splunk MCP Server.
- ReplaceÂ `<YOUR_TOKEN>`Â with the authentication token generated during the Splunk preparation step.
- The environment variableÂ `"NODE_TLS_REJECT_UNAUTHORIZED": "0"`** disables TLS certificate validation in Node.js**. This setting can be useful in development or testing environments when working with self-signed certificates, but itÂ **must not be used in production**, as it makes the connection vulnerable to man-in-the-middle attacks.
- Save the configuration file asÂ `claude_desktop_config.json`Â in the Claude Desktop installation directory.

This configuration enables Claude to communicate with the Splunk MCP Server via the MCP protocol.

You can verify this setup in Claude underÂ **Settings â†’ Developer**Â orÂ **Settings â†’ Connectors**, as shown below.

<p align="center">
  <img src="/assets/img/blog/2026-01-17-claude-mcp-client.webp" alt="Claude MCP Client Configuration View" width="600"/>
  <br><em>Claude MCP Client Configuration View</em>
</p>

### **ğŸ§© Step 4: DefineÂ Prompts**

Define initial prompts to validate the MCP integration and provide contextual awareness of the Splunk environment.

For example, start with a discovery prompt to list all available indexes:Â *â€œ**List all available Splunk indexes.**â€*

You should see all available indexes in your Splunk environment, as shown below.

<p align="center">
  <img src="/assets/img/blog/2026-01-17-claude-prompt.webp" alt="Executing a Sample Prompt inÂ Claude" width="600"/>
  <br><em>Executing a Sample Prompt inÂ Claude</em>
</p>

### **What Happens During aÂ Query?**

At a high level, a query follows this path:

> User â†’ Claude (Host) â†’ MCP Client â†’ Splunk MCP Server â†’ Splunk REST API â†’ Result
> 

**1ï¸âƒ£ Host: Claude (Web, Desktop, or Agent Runtime)**

TheÂ **Host**Â is the environment where Claude runs and where user interaction takes place.

The user expresses intent using natural language, for example:

> â€œAnalyze failed login attempts in Splunk over the last hour.â€
> 

Claude does not immediately call a backend API. Instead, it first interprets the intent and determines how to fulfill the request using the tools exposed by the MCP Server.

At this stage, Claude:

- Accepts theÂ **user prompt**
- Determines thatÂ **Splunk data**Â is required
- Plans a multi-stepÂ **tool-based workflow**
- Delegates execution to the MCP Client

**2ï¸âƒ£ MCP Client: The Protocol Layer Inside Claude**

TheÂ **MCP Client**Â works only in the background as part of Claude.

Its core responsibilities include:

- Discovering availableÂ **MCP tools**
- **Generating JSON-RPC requests**
- Invoking tools such asÂ [**tools/list**Â andÂ **tools/call**](https://modelcontextprotocol.io/specification/2025-06-18/server/tools)

In short, the MCP Client acts as aÂ [**protocol translator**](https://modelcontextprotocol.io/specification/2025-06-18/basic/transports), converting Claudeâ€™s reasoning into structuredÂ **machine-to-machine requests**.

**3ï¸âƒ£ Splunk MCP Server: The Integration Layer**

TheÂ **Splunk MCP Server**Â is the component deployed to integrate Claude with Splunk. It:

- **Receives JSON-RPC requests**Â from the MCP Client
- Maps each request to aÂ **specific Splunk capability**
- Communicates with Splunk via REST APIs
- ReturnsÂ **structured results**Â back to Claude

Commonly exposed tools include:Â `get_indexes`,Â `get_index_info`,Â `run_splunk_query`, etc.

For example, when Claude needs to analyze failed login attempts, it selects theÂ `run_splunk_query`Â tool. The MCP Client generates a JSON-RPC request, the MCP Server executes the corresponding Splunk REST API call, and the response is returned to Claude.

**ğŸ«§ JSON-RPC and Execution Flow**

JSON-RPC provides a clean and standardized way to execute tools:

- Claude decides which tool to invoke
- The MCP Client serializes the request using JSON-RPC
- The MCP Server executes the backend logic in Splunk
- A correlated JSON-RPC response is returned

This approach cleanly separatesÂ **reasoning**,Â **execution**, andÂ **data access**.

**4ï¸âƒ£ From Raw Results to Human Insight**

Once the response is received, Claude takes over again.

Rather than returning raw JSON or SPL output, Claude:

- Interprets the data
- Identifies patterns and anomalies
- **Summarizes findings**
- Presents insights in natural language

For example:

> â€œIn the last hour, 342 failed login attempts were detected. Most attempts targeted the admin account, with 70% originating from external IP addresses.â€
> 

### ***ğŸ«§*Â Bonus: Using Continue as an MCP Client forÂ LLMs**

[**Continue**](https://docs.continue.dev/customize/deep-dives/mcp)Â offers a VS Code extension that acts as an MCP client, allowing easy connection of an LLM to MCP servers via a simple config file. Itâ€™s a convenient tool for experimenting with MCP-based integrations during development.

By adding your MCP server configuration to theÂ `.continue/config.yaml`Â file, you can connect Continue to your MCP server and expose its tools to the selected LLM.

### **ğŸ“š References**

- [**MCP Docs:**Â Model Context Protocol](https://modelcontextprotocol.io/docs/getting-started/intro)
- [**Splunk Docs:**Â Splunk MCP Server](https://help.splunk.com/en/splunk-cloud-platform/mcp-server-for-splunk-platform/about-the-mcp-server-for-splunk-platform)
- [**Splunkbase:**Â Splunk MCP Server](https://splunkbase.splunk.com/app/7931)
- [**Claude Docs:**Â Connect Claude Code to tools via MCP](https://code.claude.com/docs/en/mcp)
- [**MCP: Concept and Operation**](https://www.descope.com/learn/post/mcp)
- [**Continue Docs:**Â Continue VS Code Extension](https://docs.continue.dev/customize/deep-dives/mcp)